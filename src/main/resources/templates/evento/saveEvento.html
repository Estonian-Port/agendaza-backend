<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="author" content="colorlib.com">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Agregar nuevo evento</title>

    <!-- Font Icon -->
    <link rel="stylesheet" href="../fonts/material-icon/css/material-design-iconic-font.min.css">
    <link rel="stylesheet" href="../vendor/nouislider/nouislider.min.css">


<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="../vendor/bootstrap/css/bootstrap.min.css">
<!--===============================================================================================-->


    <!-- Main css -->
    <link rel="stylesheet" href="../css/saveEvento.css">
    
    
</head>

<body>

    <div class="main">

        <div class="container">
            <form th:action="@{/saveEvento}" method="post" th:object="${eventoExtraContainer}" id="signup-form" class="signup-form">
                <div>
                    <h3>Datos iniciales</h3>
                    <fieldset>
                        <h2>Agregar nuevo evento</h2>
                        <p class="desc">Cree el nuevo evento a realizar en el salon X</p>
                        <div class="fieldset-content">
                            <div class="form-row">
                                <label class="form-label">Nombre del evento</label>
                                <div class="form-flex">
                                    <div class="form-group">
										<input type="text" class="form-control" id="nombre" th:field="*{evento.nombre}" name="nombre" required>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="start_date" class="form-label">Inicio</label> 
								<input type="date" class="form-control" id="start_date" th:field="*{evento.start_date}" name="start_date" required>
                            </div>
				  			<div class="form-group">
								<label for="end_date" class="form-label">Finalizacion</label> 
								<input type="date" class="form-control" id="end_date" th:field="*{evento.end_date}" name="end_date" required>
							</div>
                    </fieldset>

                    <h3>Tipo de Evento</h3>
                    <fieldset>
                        <h2>Selecciones tipo de evento a realizar</h2>
                        <p class="desc">El tipo de evento a seleccionar cambiara la cantidad de horas de duracion y presupuesto final</p>

                        <div class="col">
							<select class="form-select" id="tipoEvento" th:field="*{evento.tipoEvento.id}">
								<option selected hidden th:value="0">Tipo Evento</option>
								<option th:each="subTipoEvento : ${listaSubTipoEvento}" th:class="${subTipoEvento.tipoEvento.nombre}" th:text="${subTipoEvento.tipoEvento.nombre}" th:value="${subTipoEvento.tipoEvento.id}"/>
							</select>
						</div>
						<div class="col">
							<select class="form-select" id="subTipoEvento" th:field="*{evento.subTipoEvento.id}">
								<option selected hidden th:value="0">Sub Tipo Evento</option>
								<option th:each="subTipoEvento : ${listaSubTipoEvento}" th:classappend="${subTipoEvento.nombre} + ' ' + ${subTipoEvento.tipoEvento.nombre}" th:text="${subTipoEvento.nombre}" th:value="${subTipoEvento.id}"/>
							</select>
						</div>
                    </fieldset>
                    
                    <h3>Cotizacion</h3>
                    <fieldset>
                        <h2>Presupuesto</h2>
                        <p class="desc">Puede agregar extras que cambiaran el precio final</p>
                        <div class="fieldset-content">

							<h5>Extras</h5>
                            <div class="choose-bank">
                                <th:block th:each="extra : ${listaExtra}">
	                                    <div class=form-check>
										    <input type="checkbox" class="form-check-input" name="extra" th:value="${extra.id}" th:id="'extraId' + ${extra.id}" th:attr="onChange=|changeCheckbox(${extra.precio}, 'extraId' + ${extra.id})|"/>
							  				<label class="form-check-label" th:text="${extra.nombre}">
							  			</div>
							  	</th:block>
                            </div>


                            <div class="donate-us">
                                <p class="your-money">
                                    Presupuesto final:
                                    <span id="precio" class="money"> </span>
                                </p>
                            </div>
                        </div>
                    </fieldset>
                </div>
                <button type="submit" style="display:none;"></button>
            </form>
        </div>

    </div>
    
    <!-- JS -->
    <script src="../vendor/jquery/jquery-3.2.1.min.js"></script>
    <script src="../vendor/jquery-validation/dist/jquery.validate.min.js"></script>
    <script src="../vendor/jquery-validation/dist/additional-methods.min.js"></script>
    <script src="../vendor/jquery-steps/jquery.steps.min.js"></script>
    <script src="../vendor/minimalist-picker/dobpicker.js"></script>
    <script src="../vendor/nouislider/nouislider.min.js"></script>
    <script src="../vendor/wnumb/wNumb.js"></script>
    <script src="../js/saveEvento.js"></script>
    
    <script th:inline="javascript">
    	// Busca el subTipoEvento seleccionado y setea el precio base de dicho subTipoEvento
		$('#subTipoEvento').change(function () {
			var index = document.getElementById("subTipoEvento").value -1;
			var usersArray = /*[[${listaSubTipoEvento}]]*/ [];
			if (index >= 0 && index <= usersArray.length - 1) {
				var precio = usersArray[index].precioBase;
			}
			var span = document.getElementById("precio");
			span.textContent = precio;
		})

		// Suma o resta al precio del evento, el precio del extra que haya sido checkeado
		function changeCheckbox(extraValor, extraId) {
		    var decider = document.getElementById(extraId);
			var precio = parseInt(document.getElementById("precio").innerText);
			
		    if(decider.checked){
		        precio += parseInt(extraValor);
		    } else {
		        precio -= parseInt(extraValor);		    
		    }

		    var span = document.getElementById("precio");
			span.textContent = precio;
		}
	</script>
	
</body>

</html>